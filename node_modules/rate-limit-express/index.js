exports.ratelimit = function(iplimit = 5, timelimit = 10){
    const ips = {};
    const func = function(req, res, next){
        const ip = req.ip;
        ips[ip] = ips[ip] === undefined ? 1 : ips[ip] + 1;
        setTimeout(function(){
            if(ips[ip] === 1){
                delete ips[ip];
            }
            else ips[ip] -= 1;
        }, timelimit * 1000);
        if(ips[ip] > iplimit){
            return res.status(400).send(`Error tried to access too many times. Please try again later`);
        }
        next();
    }
    return func;
}